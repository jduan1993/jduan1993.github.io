<!DOCTYPE html>
<html lang="zh" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry å®ç°å…¨é“¾è·¯è¿½è¸ªæ˜¯æå‡å¯ observabilityï¼ˆå¯è§‚æµ‹æ€§ï¼‰å’Œç³»ç»Ÿå¯ç»´æŠ¤æ€§çš„å…³é”®æ­¥éª¤ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æœ€ä½³å®è·µï¼Œæ¶µç›–ä»è®¾è®¡ã€å®ç°åˆ°éƒ¨ç½²è¿ç»´çš„å®Œæ•´è§†è§’ã€‚


  ğŸŒ ä¸€ã€OpenTelemetry ç®€ä»‹
  #

OpenTelemetry æ˜¯ç”± CNCFï¼ˆCloud Native Computing Foundationï¼‰æ‰˜ç®¡çš„å¼€æ”¾æ ‡å‡†ï¼Œæ”¯æŒ åˆ†å¸ƒå¼è¿½è¸ªï¼ˆTracingï¼‰ã€æŒ‡æ ‡ï¼ˆMetricsï¼‰ å’Œ æ—¥å¿—ï¼ˆLogsï¼‰ çš„é‡‡é›†ä¸å¯¼å‡ºã€‚å®ƒæ”¯æŒå¤šè¯­è¨€ï¼Œèƒ½å¤Ÿå°†æ•°æ®å¯¼å‡ºè‡³å¤šç§åç«¯ï¼ˆå¦‚ Jaegerã€Prometheusã€Grafana Tempoã€Datadogã€Zipkin ç­‰ï¼‰ã€‚


  ğŸ“¦ äºŒã€å…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ
  #


Traceï¼ˆè¿½è¸ªï¼‰ï¼šä¸€æ¬¡å®Œæ•´çš„è°ƒç”¨é“¾ï¼ˆå¦‚ç”¨æˆ·ä¸‹å•è¯·æ±‚ï¼‰ã€‚
Spanï¼ˆè·¨åº¦ï¼‰ï¼šè°ƒç”¨é“¾ä¸­çš„å•ä¸ªæ“ä½œï¼ˆå¦‚è®¢å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡ï¼‰ã€‚
Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼šè·¨æœåŠ¡ä¼ é€’ trace çš„å…ƒä¿¡æ¯ï¼ˆå¦‚ trace idï¼‰ã€‚



  ğŸ”§ ä¸‰ã€åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry çš„æœ€ä½³å®è·µ
  #


  âœ… 1. ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥
  #


é€‰æ‹©ç»Ÿä¸€çš„ SDK ç‰ˆæœ¬ï¼šæ‰€æœ‰æœåŠ¡ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ OpenTelemetry SDKã€‚
ä½¿ç”¨è‡ªåŠ¨æ³¨å…¥çš„æ–¹å¼æ¥å…¥ HTTP / gRPC æ¡†æ¶ï¼šä¾‹å¦‚ Spring Boot &#43; Spring Cloud Sleuthï¼ŒPython FastAPI &#43; OpenTelemetry middlewareï¼ŒGo &#43; OpenTelemetry HTTP æ’ä»¶ã€‚
å°½é‡é¿å…æ‰‹åŠ¨åˆ›å»º spanï¼Œä½¿ç”¨å°è£…çš„ middleware æˆ–æ¡†æ¶æ”¯æŒã€‚



  ğŸ”— 2. ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’ï¼ˆContext Propagationï¼‰
  #


ä½¿ç”¨æ ‡å‡†åè®®ï¼ˆå¦‚ W3C Trace Contextï¼‰ä¼ é€’ trace ä¸Šä¸‹æ–‡ã€‚
åœ¨æ‰€æœ‰æœåŠ¡é—´è°ƒç”¨ï¼ˆREST/gRPC/Kafka/NATSï¼‰æ—¶ï¼Œæ˜¾å¼æˆ–è‡ªåŠ¨ä¼ é€’ traceparentã€baggage ç­‰ headersã€‚
ç¡®ä¿æ‰€æœ‰æœåŠ¡çš„ç½‘å…³ã€API å±‚ã€å¼‚æ­¥æ¶ˆæ¯ç³»ç»Ÿéƒ½èƒ½æ­£ç¡®ä¼ é€’ trace contextã€‚



  ğŸ“¤ 3. é€‰æ‹©åˆé€‚çš„åç«¯ï¼ˆExporterï¼‰
  #

å¸¸è§å¯¼å‡ºç›®æ ‡ï¼š">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/introspection/trace/">
  <meta property="og:site_name" content="å›å®çš„ç¬”è®°">
  <meta property="og:title" content="OpenTelemetry å…¨é“¾è·¯è¿½è¸ª">
  <meta property="og:description" content="åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry å®ç°å…¨é“¾è·¯è¿½è¸ªæ˜¯æå‡å¯ observabilityï¼ˆå¯è§‚æµ‹æ€§ï¼‰å’Œç³»ç»Ÿå¯ç»´æŠ¤æ€§çš„å…³é”®æ­¥éª¤ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æœ€ä½³å®è·µï¼Œæ¶µç›–ä»è®¾è®¡ã€å®ç°åˆ°éƒ¨ç½²è¿ç»´çš„å®Œæ•´è§†è§’ã€‚
ğŸŒ ä¸€ã€OpenTelemetry ç®€ä»‹#OpenTelemetry æ˜¯ç”± CNCFï¼ˆCloud Native Computing Foundationï¼‰æ‰˜ç®¡çš„å¼€æ”¾æ ‡å‡†ï¼Œæ”¯æŒ åˆ†å¸ƒå¼è¿½è¸ªï¼ˆTracingï¼‰ã€æŒ‡æ ‡ï¼ˆMetricsï¼‰ å’Œ æ—¥å¿—ï¼ˆLogsï¼‰ çš„é‡‡é›†ä¸å¯¼å‡ºã€‚å®ƒæ”¯æŒå¤šè¯­è¨€ï¼Œèƒ½å¤Ÿå°†æ•°æ®å¯¼å‡ºè‡³å¤šç§åç«¯ï¼ˆå¦‚ Jaegerã€Prometheusã€Grafana Tempoã€Datadogã€Zipkin ç­‰ï¼‰ã€‚
ğŸ“¦ äºŒã€å…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ#Traceï¼ˆè¿½è¸ªï¼‰ï¼šä¸€æ¬¡å®Œæ•´çš„è°ƒç”¨é“¾ï¼ˆå¦‚ç”¨æˆ·ä¸‹å•è¯·æ±‚ï¼‰ã€‚ Spanï¼ˆè·¨åº¦ï¼‰ï¼šè°ƒç”¨é“¾ä¸­çš„å•ä¸ªæ“ä½œï¼ˆå¦‚è®¢å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡ï¼‰ã€‚ Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼šè·¨æœåŠ¡ä¼ é€’ trace çš„å…ƒä¿¡æ¯ï¼ˆå¦‚ trace idï¼‰ã€‚ ğŸ”§ ä¸‰ã€åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry çš„æœ€ä½³å®è·µ#âœ… 1. ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥#é€‰æ‹©ç»Ÿä¸€çš„ SDK ç‰ˆæœ¬ï¼šæ‰€æœ‰æœåŠ¡ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ OpenTelemetry SDKã€‚ ä½¿ç”¨è‡ªåŠ¨æ³¨å…¥çš„æ–¹å¼æ¥å…¥ HTTP / gRPC æ¡†æ¶ï¼šä¾‹å¦‚ Spring Boot &#43; Spring Cloud Sleuthï¼ŒPython FastAPI &#43; OpenTelemetry middlewareï¼ŒGo &#43; OpenTelemetry HTTP æ’ä»¶ã€‚ å°½é‡é¿å…æ‰‹åŠ¨åˆ›å»º spanï¼Œä½¿ç”¨å°è£…çš„ middleware æˆ–æ¡†æ¶æ”¯æŒã€‚ ğŸ”— 2. ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’ï¼ˆContext Propagationï¼‰#ä½¿ç”¨æ ‡å‡†åè®®ï¼ˆå¦‚ W3C Trace Contextï¼‰ä¼ é€’ trace ä¸Šä¸‹æ–‡ã€‚ åœ¨æ‰€æœ‰æœåŠ¡é—´è°ƒç”¨ï¼ˆREST/gRPC/Kafka/NATSï¼‰æ—¶ï¼Œæ˜¾å¼æˆ–è‡ªåŠ¨ä¼ é€’ traceparentã€baggage ç­‰ headersã€‚ ç¡®ä¿æ‰€æœ‰æœåŠ¡çš„ç½‘å…³ã€API å±‚ã€å¼‚æ­¥æ¶ˆæ¯ç³»ç»Ÿéƒ½èƒ½æ­£ç¡®ä¼ é€’ trace contextã€‚ ğŸ“¤ 3. é€‰æ‹©åˆé€‚çš„åç«¯ï¼ˆExporterï¼‰#å¸¸è§å¯¼å‡ºç›®æ ‡ï¼š">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2025-07-07T15:41:53+08:00">
<title>OpenTelemetry å…¨é“¾è·¯è¿½è¸ª | å›å®çš„ç¬”è®°</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/introspection/trace/">
<link rel="stylesheet" href="/book.min.06d84d78247e572aefdb64432e406e1f78a9ead4ef25479efa82ff79bd6c0873.css" integrity="sha256-BthNeCR&#43;Vyrv22RDLkBuH3ip6tTvJUee&#43;oL/eb1sCHM=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/zh.search.min.98d6c76cea8c5502ec7a8445029c9a9d96569cca23e2fea85075ca9276555d02.js" integrity="sha256-mNbHbOqMVQLseoRFApyanZZWnMoj4v6oUHXKknZVXQI=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>å›å®çš„ç¬”è®°</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="æœç´¢" aria-label="æœç´¢" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>



  



  
    
  



<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex justify-between">
      <a role="button" class="flex align-center">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        ç®€ä½“ä¸­æ–‡
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/en/">
          English
        </a>
      </li>
      
    </ul>
  </li>
</ul>














  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-51faac69e5e901597a0480b538fe5e9e" class="toggle"  />
    <label for="section-51faac69e5e901597a0480b538fe5e9e" class="flex justify-between">
      <a role="button" class="">å­¦ä¹ èµ„æ–™</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-582da456f48414d663a4153b7d734ed6" class="toggle"  />
    <label for="section-582da456f48414d663a4153b7d734ed6" class="flex justify-between">
      <a role="button" class="">å®‰å…¨</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/security/replay-attack/" class="">é‡æ”¾æ”»å‡»</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-407d2f8dd9410e8eef358914dd8c0dc2" class="toggle"  />
    <label for="section-407d2f8dd9410e8eef358914dd8c0dc2" class="flex justify-between">
      <a role="button" class="">ç¼“å­˜</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/cache/solution/" class="">æ–¹æ¡ˆ</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e8dd3e3cc6bf1cd4a7414fff39582ee8" class="toggle"  />
    <label for="section-e8dd3e3cc6bf1cd4a7414fff39582ee8" class="flex justify-between">
      <a role="button" class="">åŸºç¡€</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/base/python/" class="">Python åŸºç¡€</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/base/saga-best-practices/" class="">Saga æ¨¡å¼æœ€ä½³å®è·µ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/base/algorithm/" class="">ç®—æ³•</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/base/license-comparison/" class="">ä¸»æµè®¸å¯è¯å¯¹æ¯”</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-57eec37e4d3dd0c268dbeb31bc61d4b1" class="toggle"  />
    <label for="section-57eec37e4d3dd0c268dbeb31bc61d4b1" class="flex justify-between">
      <a role="button" class="">å‰ç«¯</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/frontend/react-knowledge/" class="">React çŸ¥è¯†</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-70d792a755054f6bbbb3adad5db99041" class="toggle"  />
    <label for="section-70d792a755054f6bbbb3adad5db99041" class="flex justify-between">
      <a role="button" class="">æ•°æ®åº“</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/database/postgresql-mysql/" class="">PostgreSQL vs MySQL (InnoDB) é€‰å‹</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3ba9e8b376ea48d5beb815b520fdce5d" class="toggle"  />
    <label for="section-3ba9e8b376ea48d5beb815b520fdce5d" class="flex justify-between">
      <a role="button" class="">ç½‘ç»œ</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/network/http-comparison/" class="">HTTP åè®®å„ç‰ˆæœ¬æ¯”è¾ƒ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/network/rtt/" class="">å¾€è¿”æ—¶é—´ï¼ˆRound Trip Timeï¼‰</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a1d7a3583cdff606ffe4820acf270df1" class="toggle"  />
    <label for="section-a1d7a3583cdff606ffe4820acf270df1" class="flex justify-between">
      <a role="button" class="">ç³»ç»Ÿè®¾è®¡</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/system-design/system-design/" class="">ç³»ç»Ÿè®¾è®¡</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/system-design/doctolib-tips/" class="">Doctolib å¤§çº²</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/system-design/doctolib-system-design/" class="">Doctolib ç³»ç»Ÿè®¾è®¡</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/system-design/rpc/" class="">RPC æ¡†æ¶</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/system-design/high-availability/" class="">é«˜å¯ç”¨æ€§</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/system-design/cache-consistency/" class="">ç¼“å­˜ä¸€è‡´æ€§</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-92f7d13098d747ba4906005529a0358a" class="toggle"  />
    <label for="section-92f7d13098d747ba4906005529a0358a" class="flex justify-between">
      <a role="button" class="">ä¸­é—´ä»¶</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <span>Kafka</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/middleware/kafka/exactly-once/" class="">Kafka Exactly-Once</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/middleware/kafka/microservices-comm/" class="">å¾®æœåŠ¡é€šä¿¡</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/study/middleware/netty/" class="">Netty è¯¦è§£</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <span>OAuth2</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/study/middleware/oauth2/auth-code/" class="">æˆæƒç æ¨¡å¼</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-6711a471a1458349986928f5c4b580ef" class="toggle" checked />
    <label for="section-6711a471a1458349986928f5c4b580ef" class="flex justify-between">
      <a role="button" class="">è‡ªçœ</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/introspection/thread-pool/" class="">Java çº¿ç¨‹æ± </a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/introspection/juc/" class="">Java.util.concurrent åŒ…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/introspection/trace/" class="active">OpenTelemetry å…¨é“¾è·¯è¿½è¸ª</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-06148cf0da5a87ffda4f34920eae5a83" class="toggle"  />
    <label for="section-06148cf0da5a87ffda4f34920eae5a83" class="flex justify-between">
      <a href="/docs/example/" class="">Example Site</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/example/table-of-contents/" class="">Table of Contents</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/example/table-of-contents/with-toc/" class="">With ToC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/example/table-of-contents/without-toc/" class="">Without ToC</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-dcab297e11de79eb42396c59d3314623" class="toggle"  />
    <label for="section-dcab297e11de79eb42396c59d3314623" class="flex justify-between">
      <a role="button" class="">Collapsed</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/example/collapsed/3rd-level/" class="">3rd Level</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/example/collapsed/3rd-level/4th-level/" class="">4th Level</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/example/introduction/" class="">ä»‹ç»</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-25b4439e87cf8c09de5a8727ce755d08" class="toggle"  />
    <label for="section-25b4439e87cf8c09de5a8727ce755d08" class="flex justify-between">
      <a role="button" class="">Shortcodes</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/shortcodes/buttons/" class="">Buttons</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/shortcodes/columns/" class="">Columns</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/shortcodes/details/" class="">Details</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/shortcodes/hints/" class="">Hints</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/shortcodes/mermaid/" class="">Mermaid</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/shortcodes/tabs/" class="">Tabs</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/shortcodes/katex/" class="">KaTeX</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>










  
<ul>
  
  <li>
    <a href="https://github.com/jduan1993"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>OpenTelemetry å…¨é“¾è·¯è¿½è¸ª</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">

  
  <aside class="hidden clearfix">
    
  
<style>
    .no-marker::marker {
        content: none;
    }
</style>
<li class="no-marker"><a href="#OpenTelemetry%20%e5%85%a8%e9%93%be%e8%b7%af%e8%bf%bd%e8%b8%aa">OpenTelemetry å…¨é“¾è·¯è¿½è¸ª</a></li>
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#-ä¸€opentelemetry-ç®€ä»‹">ğŸŒ ä¸€ã€OpenTelemetry ç®€ä»‹</a></li>
        <li><a href="#-äºŒå…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ">ğŸ“¦ äºŒã€å…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ</a></li>
        <li><a href="#-ä¸‰åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨-opentelemetry-çš„æœ€ä½³å®è·µ">ğŸ”§ ä¸‰ã€åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry çš„æœ€ä½³å®è·µ</a>
          <ul>
            <li><a href="#-1-ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥">âœ… 1. <strong>ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥</strong></a></li>
            <li><a href="#-2-ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’context-propagation">ğŸ”— 2. <strong>ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’ï¼ˆContext Propagationï¼‰</strong></a></li>
            <li><a href="#-3-é€‰æ‹©åˆé€‚çš„åç«¯exporter">ğŸ“¤ 3. <strong>é€‰æ‹©åˆé€‚çš„åç«¯ï¼ˆExporterï¼‰</strong></a></li>
            <li><a href="#-4-æ•´åˆæ—¥å¿—ä¸æŒ‡æ ‡logs--metrics">ğŸ§© 4. <strong>æ•´åˆæ—¥å¿—ä¸æŒ‡æ ‡ï¼ˆLogs &amp; Metricsï¼‰</strong></a></li>
            <li><a href="#-5-é‡‡æ ·ç­–ç•¥samplingè®¾è®¡">ğŸ“Š 5. <strong>é‡‡æ ·ç­–ç•¥ï¼ˆSamplingï¼‰è®¾è®¡</strong></a></li>
            <li><a href="#-6-å¼‚æ­¥è°ƒç”¨ä¸æ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ">ğŸ§ª 6. <strong>å¼‚æ­¥è°ƒç”¨ä¸æ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ</strong></a></li>
            <li><a href="#-7-éƒ¨ç½²ä¸ç›‘æ§å»ºè®®">ğŸš€ 7. <strong>éƒ¨ç½²ä¸ç›‘æ§å»ºè®®</strong></a></li>
          </ul>
        </li>
        <li><a href="#-å››å·¥å…·é“¾æ¨è">ğŸ§° å››ã€å·¥å…·é“¾æ¨è</a></li>
        <li><a href="#-äº”æ€»ç»“">ğŸ§  äº”ã€æ€»ç»“</a></li>
        <li><a href="#-java-ç¤ºä¾‹spring-boot--opentelemetry--jaeger">â˜• Java ç¤ºä¾‹ï¼ˆSpring Boot + OpenTelemetry + Jaegerï¼‰</a>
          <ul>
            <li><a href="#1-maven-ä¾èµ–spring-boot-3">1ï¸âƒ£ Maven ä¾èµ–ï¼ˆSpring Boot 3+ï¼‰</a></li>
            <li><a href="#2-applicationyml-é…ç½®">2ï¸âƒ£ application.yml é…ç½®</a></li>
            <li><a href="#3-æ§åˆ¶å™¨--è°ƒç”¨å¤–éƒ¨æœåŠ¡ç¤ºä¾‹">3ï¸âƒ£ æ§åˆ¶å™¨ + è°ƒç”¨å¤–éƒ¨æœåŠ¡ç¤ºä¾‹</a></li>
            <li><a href="#4-æ—¥å¿—æ³¨å…¥-traceid">4ï¸âƒ£ æ—¥å¿—æ³¨å…¥ TraceId</a></li>
          </ul>
        </li>
        <li><a href="#-python-ç¤ºä¾‹fastapi--opentelemetry">ğŸ Python ç¤ºä¾‹ï¼ˆFastAPI + OpenTelemetryï¼‰</a>
          <ul>
            <li><a href="#1-å®‰è£…ä¾èµ–">1ï¸âƒ£ å®‰è£…ä¾èµ–</a></li>
            <li><a href="#2-åˆå§‹åŒ–-otelmainpy">2ï¸âƒ£ åˆå§‹åŒ– OTELï¼ˆmain.pyï¼‰</a></li>
            <li><a href="#3-è°ƒç”¨é“¾ä¸Šä¸‹æ¸¸ä¼ æ’­">3ï¸âƒ£ è°ƒç”¨é“¾ä¸Šä¸‹æ¸¸ä¼ æ’­</a></li>
          </ul>
        </li>
        <li><a href="#-æœ€ä½³å®è·µä½“ç°">ğŸ¯ æœ€ä½³å®è·µä½“ç°</a></li>
        <li><a href="#-æ¨èéƒ¨ç½²ç»„åˆ">ğŸ“¦ æ¨èéƒ¨ç½²ç»„åˆ</a></li>
        <li><a href="#-ä¸€ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼ é€’">âœ… ä¸€ã€ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼ é€’ï¼Ÿ</a></li>
        <li><a href="#-äºŒè‡ªåŠ¨ä¸Šä¸‹æ–‡ä¼ é€’çš„æ ¸å¿ƒæœºåˆ¶">ğŸ”§ äºŒã€è‡ªåŠ¨ä¸Šä¸‹æ–‡ä¼ é€’çš„æ ¸å¿ƒæœºåˆ¶</a>
          <ul>
            <li><a href="#-å…³é”®-header-ç¤ºä¾‹w3c-trace-context">ğŸ’¡ å…³é”® Header ç¤ºä¾‹ï¼ˆW3C Trace Contextï¼‰</a></li>
          </ul>
        </li>
        <li><a href="#-ä¸‰å¦‚ä½•å¯ç”¨è‡ªåŠ¨ä¼ é€’åˆ†è¯­è¨€è¯´æ˜">âš™ï¸ ä¸‰ã€å¦‚ä½•å¯ç”¨è‡ªåŠ¨ä¼ é€’ï¼ˆåˆ†è¯­è¨€è¯´æ˜ï¼‰</a>
          <ul>
            <li><a href="#-javaspring-boot--opentelemetry">â˜• Javaï¼ˆSpring Boot / OpenTelemetryï¼‰</a></li>
            <li><a href="#-pythonfastapi--flask">ğŸ Pythonï¼ˆFastAPI / Flaskï¼‰</a></li>
            <li><a href="#-gohttp-æˆ–-grpc">ğŸ¹ Goï¼ˆHTTP æˆ– gRPCï¼‰</a></li>
          </ul>
        </li>
        <li><a href="#-å››åœ¨æ¶ˆæ¯é˜Ÿåˆ—--kafka--grpc-ä¸­ä¼ é€’ä¸Šä¸‹æ–‡">ğŸ“¥ å››ã€åœ¨æ¶ˆæ¯é˜Ÿåˆ— / Kafka / gRPC ä¸­ä¼ é€’ä¸Šä¸‹æ–‡</a>
          <ul>
            <li><a href="#-kafkajava-ç¤ºä¾‹">ğŸ“¨ Kafkaï¼ˆJava ç¤ºä¾‹ï¼‰</a></li>
          </ul>
        </li>
        <li><a href="#-äº”éƒ¨ç½²ç¯å¢ƒè¦æ±‚">âœ… äº”ã€éƒ¨ç½²ç¯å¢ƒè¦æ±‚</a></li>
        <li><a href="#-å…­éªŒè¯è‡ªåŠ¨ä¸Šä¸‹æ–‡æ˜¯å¦ä¼ é€’æˆåŠŸ">ğŸ§ª å…­ã€éªŒè¯è‡ªåŠ¨ä¸Šä¸‹æ–‡æ˜¯å¦ä¼ é€’æˆåŠŸ</a></li>
        <li><a href="#-ä¸ƒå°ç»“">ğŸ§  ä¸ƒã€å°ç»“</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1 id="OpenTelemetry å…¨é“¾è·¯è¿½è¸ª">
    OpenTelemetry å…¨é“¾è·¯è¿½è¸ª
    <a class="anchor" href="#OpenTelemetry%20%e5%85%a8%e9%93%be%e8%b7%af%e8%bf%bd%e8%b8%aa">#</a>
  </h1>
  
  <div><a class="flex align-center" href="https://github.com/jduan1993/jduan1993.github.io/commit/cfe517ae9cddcd8f1f8302a1f9c18d065c16be6b" title='æœ€åä¿®æ”¹è€… jduan1993 | ä¸ƒæœˆ 7, 2025' target="_blank" rel="noopener">
    <img src="/svg/calendar.svg" class="book-icon" alt="" />
    <span>ä¸ƒæœˆ 7, 2025</span>
    </a>
  </div>
  
  


  

  


  <div class="book-post-content"><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry å®ç°å…¨é“¾è·¯è¿½è¸ªæ˜¯æå‡å¯ observabilityï¼ˆå¯è§‚æµ‹æ€§ï¼‰å’Œç³»ç»Ÿå¯ç»´æŠ¤æ€§çš„å…³é”®æ­¥éª¤ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æœ€ä½³å®è·µï¼Œæ¶µç›–ä»è®¾è®¡ã€å®ç°åˆ°éƒ¨ç½²è¿ç»´çš„å®Œæ•´è§†è§’ã€‚</p>
<hr>
<h2 id="-ä¸€opentelemetry-ç®€ä»‹">
  ğŸŒ ä¸€ã€OpenTelemetry ç®€ä»‹
  <a class="anchor" href="#-%e4%b8%80opentelemetry-%e7%ae%80%e4%bb%8b">#</a>
</h2>
<p>OpenTelemetry æ˜¯ç”± CNCFï¼ˆCloud Native Computing Foundationï¼‰æ‰˜ç®¡çš„å¼€æ”¾æ ‡å‡†ï¼Œæ”¯æŒ <strong>åˆ†å¸ƒå¼è¿½è¸ªï¼ˆTracingï¼‰</strong>ã€<strong>æŒ‡æ ‡ï¼ˆMetricsï¼‰</strong> å’Œ <strong>æ—¥å¿—ï¼ˆLogsï¼‰</strong> çš„é‡‡é›†ä¸å¯¼å‡ºã€‚å®ƒæ”¯æŒå¤šè¯­è¨€ï¼Œèƒ½å¤Ÿå°†æ•°æ®å¯¼å‡ºè‡³å¤šç§åç«¯ï¼ˆå¦‚ Jaegerã€Prometheusã€Grafana Tempoã€Datadogã€Zipkin ç­‰ï¼‰ã€‚</p>
<hr>
<h2 id="-äºŒå…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ">
  ğŸ“¦ äºŒã€å…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ
  <a class="anchor" href="#-%e4%ba%8c%e5%85%a8%e9%93%be%e8%b7%af%e8%bf%bd%e8%b8%aa%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5">#</a>
</h2>
<ol>
<li><strong>Traceï¼ˆè¿½è¸ªï¼‰</strong>ï¼šä¸€æ¬¡å®Œæ•´çš„è°ƒç”¨é“¾ï¼ˆå¦‚ç”¨æˆ·ä¸‹å•è¯·æ±‚ï¼‰ã€‚</li>
<li><strong>Spanï¼ˆè·¨åº¦ï¼‰</strong>ï¼šè°ƒç”¨é“¾ä¸­çš„å•ä¸ªæ“ä½œï¼ˆå¦‚è®¢å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡ï¼‰ã€‚</li>
<li><strong>Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰</strong>ï¼šè·¨æœåŠ¡ä¼ é€’ trace çš„å…ƒä¿¡æ¯ï¼ˆå¦‚ trace idï¼‰ã€‚</li>
</ol>
<hr>
<h2 id="-ä¸‰åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨-opentelemetry-çš„æœ€ä½³å®è·µ">
  ğŸ”§ ä¸‰ã€åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry çš„æœ€ä½³å®è·µ
  <a class="anchor" href="#-%e4%b8%89%e5%9c%a8%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84%e4%b8%ad%e4%bd%bf%e7%94%a8-opentelemetry-%e7%9a%84%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5">#</a>
</h2>
<h3 id="-1-ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥">
  âœ… 1. <strong>ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥</strong>
  <a class="anchor" href="#-1-%e7%bb%9f%e4%b8%80%e8%a7%84%e8%8c%83%e5%92%8c%e8%87%aa%e5%8a%a8%e5%8c%96%e6%8e%a5%e5%85%a5">#</a>
</h3>
<ul>
<li><strong>é€‰æ‹©ç»Ÿä¸€çš„ SDK ç‰ˆæœ¬</strong>ï¼šæ‰€æœ‰æœåŠ¡ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ OpenTelemetry SDKã€‚</li>
<li><strong>ä½¿ç”¨è‡ªåŠ¨æ³¨å…¥çš„æ–¹å¼æ¥å…¥ HTTP / gRPC æ¡†æ¶</strong>ï¼šä¾‹å¦‚ Spring Boot + Spring Cloud Sleuthï¼ŒPython FastAPI + OpenTelemetry middlewareï¼ŒGo + OpenTelemetry HTTP æ’ä»¶ã€‚</li>
<li><strong>å°½é‡é¿å…æ‰‹åŠ¨åˆ›å»º spanï¼Œä½¿ç”¨å°è£…çš„ middleware æˆ–æ¡†æ¶æ”¯æŒ</strong>ã€‚</li>
</ul>
<hr>
<h3 id="-2-ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’context-propagation">
  ğŸ”— 2. <strong>ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’ï¼ˆContext Propagationï¼‰</strong>
  <a class="anchor" href="#-2-%e7%bb%9f%e4%b8%80%e4%b8%8a%e4%b8%8b%e6%96%87%e4%bc%a0%e9%80%92context-propagation">#</a>
</h3>
<ul>
<li>ä½¿ç”¨æ ‡å‡†åè®®ï¼ˆå¦‚ W3C Trace Contextï¼‰ä¼ é€’ trace ä¸Šä¸‹æ–‡ã€‚</li>
<li>åœ¨æ‰€æœ‰æœåŠ¡é—´è°ƒç”¨ï¼ˆREST/gRPC/Kafka/NATSï¼‰æ—¶ï¼Œæ˜¾å¼æˆ–è‡ªåŠ¨ä¼ é€’ <code>traceparent</code>ã€<code>baggage</code> ç­‰ headersã€‚</li>
<li>ç¡®ä¿æ‰€æœ‰æœåŠ¡çš„ç½‘å…³ã€API å±‚ã€å¼‚æ­¥æ¶ˆæ¯ç³»ç»Ÿéƒ½èƒ½æ­£ç¡®ä¼ é€’ trace contextã€‚</li>
</ul>
<hr>
<h3 id="-3-é€‰æ‹©åˆé€‚çš„åç«¯exporter">
  ğŸ“¤ 3. <strong>é€‰æ‹©åˆé€‚çš„åç«¯ï¼ˆExporterï¼‰</strong>
  <a class="anchor" href="#-3-%e9%80%89%e6%8b%a9%e5%90%88%e9%80%82%e7%9a%84%e5%90%8e%e7%ab%afexporter">#</a>
</h3>
<p>å¸¸è§å¯¼å‡ºç›®æ ‡ï¼š</p>
<ul>
<li><strong>Jaeger / Zipkin</strong>ï¼ˆè½»é‡éƒ¨ç½²ï¼‰</li>
<li><strong>Grafana Tempo</strong>ï¼ˆå¯ä¸ Lokiã€Prometheus é›†æˆï¼‰</li>
<li><strong>Datadog / New Relic / AWS X-Ray / Google Cloud Trace</strong>ï¼ˆSaaSï¼‰</li>
</ul>
<p>å»ºè®®ï¼š</p>
<ul>
<li>å¼€å‘å’Œæµ‹è¯•ä½¿ç”¨ Jaegerï¼Œç”Ÿäº§å»ºè®®ä½¿ç”¨æ›´å…·å¯æ‰©å±•æ€§å’Œå¯é›†æˆæ€§çš„åç«¯ã€‚</li>
<li>å°† Trace æ•°æ®ä¸ Metricsã€Logs æ±‡èšåˆ°ç»Ÿä¸€å¹³å°ï¼ˆå¦‚ Grafana Stackï¼‰ã€‚</li>
</ul>
<hr>
<h3 id="-4-æ•´åˆæ—¥å¿—ä¸æŒ‡æ ‡logs--metrics">
  ğŸ§© 4. <strong>æ•´åˆæ—¥å¿—ä¸æŒ‡æ ‡ï¼ˆLogs &amp; Metricsï¼‰</strong>
  <a class="anchor" href="#-4-%e6%95%b4%e5%90%88%e6%97%a5%e5%bf%97%e4%b8%8e%e6%8c%87%e6%a0%87logs--metrics">#</a>
</h3>
<ul>
<li>
<p>å°† TraceId æ³¨å…¥æ—¥å¿—ä¸Šä¸‹æ–‡ï¼ˆå¦‚ Logback / Log4j çš„ MDCï¼ŒPython çš„ logging filterï¼‰ã€‚</p>
</li>
<li>
<p>å®ç°â€œä»æ—¥å¿—è·³è½¬åˆ° Traceâ€ï¼Œâ€œä» Trace è·³è½¬åˆ° Metricsâ€çš„é—­ç¯è§‚æµ‹ã€‚</p>
</li>
<li>
<p>ç¤ºä¾‹æ—¥å¿—æ ¼å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;timestamp&#34;</span>: <span style="color:#e6db74">&#34;2025-07-07T10:10:00Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;level&#34;</span>: <span style="color:#e6db74">&#34;INFO&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;trace_id&#34;</span>: <span style="color:#e6db74">&#34;abc123&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;span_id&#34;</span>: <span style="color:#e6db74">&#34;def456&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Order created successfully&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
<hr>
<h3 id="-5-é‡‡æ ·ç­–ç•¥samplingè®¾è®¡">
  ğŸ“Š 5. <strong>é‡‡æ ·ç­–ç•¥ï¼ˆSamplingï¼‰è®¾è®¡</strong>
  <a class="anchor" href="#-5-%e9%87%87%e6%a0%b7%e7%ad%96%e7%95%a5sampling%e8%ae%be%e8%ae%a1">#</a>
</h3>
<ul>
<li><strong>Always on</strong>ï¼šå¼€å‘è°ƒè¯•æ—¶ä½¿ç”¨ã€‚</li>
<li><strong>Probabilistic sampling</strong>ï¼šæŒ‰æ¦‚ç‡é‡‡æ ·ï¼Œé€‚åˆé«˜æµé‡ç”Ÿäº§ç¯å¢ƒã€‚</li>
<li><strong>Tail-based sampling</strong>ï¼šå…ˆæ”¶é›†ï¼Œå†åˆ¤æ–­æ˜¯å¦ä¿ç•™ï¼Œé€‚ç”¨äºé“¾è·¯åˆ†æã€‚</li>
<li><strong>è‡ªå®šä¹‰ç­–ç•¥</strong>ï¼šå¯¹å…³é”®ä¸šåŠ¡è·¯å¾„ã€å¼‚å¸¸é“¾è·¯æé«˜é‡‡æ ·ç‡ã€‚</li>
</ul>
<hr>
<h3 id="-6-å¼‚æ­¥è°ƒç”¨ä¸æ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ">
  ğŸ§ª 6. <strong>å¼‚æ­¥è°ƒç”¨ä¸æ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ</strong>
  <a class="anchor" href="#-6-%e5%bc%82%e6%ad%a5%e8%b0%83%e7%94%a8%e4%b8%8e%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97%e6%94%af%e6%8c%81">#</a>
</h3>
<ul>
<li>
<p>Kafkaã€RabbitMQ ç­‰ä¸­é—´ä»¶ä¹Ÿéœ€è¦ä¼ é€’ TraceContextã€‚</p>
</li>
<li>
<p>ä½¿ç”¨æ¶ˆæ¯å¤´ä¼ é€’ä¸Šä¸‹æ–‡ï¼Œå¹¶åœ¨æ¶ˆè´¹è€…æ‰‹åŠ¨åˆ›å»ºæ–°çš„ spanï¼Œå…³è” parent spanã€‚</p>
</li>
<li>
<p>å»ºè®®ä½¿ç”¨å®˜æ–¹æˆ–ç¤¾åŒºæä¾›çš„ instrumentationï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><code>opentelemetry-instrumentation-kafka</code></li>
<li><code>opentelemetry-instrumentation-celery</code></li>
</ul>
</li>
</ul>
<hr>
<h3 id="-7-éƒ¨ç½²ä¸ç›‘æ§å»ºè®®">
  ğŸš€ 7. <strong>éƒ¨ç½²ä¸ç›‘æ§å»ºè®®</strong>
  <a class="anchor" href="#-7-%e9%83%a8%e7%bd%b2%e4%b8%8e%e7%9b%91%e6%8e%a7%e5%bb%ba%e8%ae%ae">#</a>
</h3>
<ul>
<li>ä½¿ç”¨ sidecar æˆ– agent æ¨¡å¼éƒ¨ç½² OTEL Collectorï¼ˆé‡‡é›†ã€è¿‡æ»¤ã€å¯¼å‡ºï¼‰ã€‚</li>
<li>å¯ç”¨èµ„æºæ£€æµ‹ï¼ˆhost name, container id, region ç­‰ï¼‰ä¾¿äºåˆ†æã€‚</li>
<li>é…ç½®ç†”æ–­æœºåˆ¶ï¼Œé˜²æ­¢è¿½è¸ªç³»ç»Ÿæ•…éšœå½±å“ä¸šåŠ¡æµã€‚</li>
</ul>
<hr>
<h2 id="-å››å·¥å…·é“¾æ¨è">
  ğŸ§° å››ã€å·¥å…·é“¾æ¨è
  <a class="anchor" href="#-%e5%9b%9b%e5%b7%a5%e5%85%b7%e9%93%be%e6%8e%a8%e8%8d%90">#</a>
</h2>
<table>
  <thead>
      <tr>
          <th>å·¥å…·/ç»„ä»¶</th>
          <th>åŠŸèƒ½</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>OpenTelemetry SDK</td>
          <td>Traceã€Metricsã€Logs é‡‡é›†</td>
          <td>å¤šè¯­è¨€æ”¯æŒ</td>
      </tr>
      <tr>
          <td>OTEL Collector</td>
          <td>ä¸­è½¬ã€è½¬ç ã€è¿‡æ»¤</td>
          <td>å¯éƒ¨ç½²ä¸º sidecar / DaemonSet / Gateway</td>
      </tr>
      <tr>
          <td>Jaeger / Zipkin</td>
          <td>å¯è§†åŒ–è¿½è¸ªé“¾è·¯</td>
          <td>å¼€æºã€è½»é‡ã€æ˜“éƒ¨ç½²</td>
      </tr>
      <tr>
          <td>Grafana Tempo</td>
          <td>å¯æ‰©å±• Trace å­˜å‚¨</td>
          <td>å¯ä¸ Lokiã€Prometheus é…åˆä½¿ç”¨</td>
      </tr>
      <tr>
          <td>Grafana / Kibana</td>
          <td>å¯è§†åŒ–åˆ†æ</td>
          <td>å¤šæ•°æ®æºæ”¯æŒ</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-äº”æ€»ç»“">
  ğŸ§  äº”ã€æ€»ç»“
  <a class="anchor" href="#-%e4%ba%94%e6%80%bb%e7%bb%93">#</a>
</h2>
<table>
  <thead>
      <tr>
          <th>å…³é”®ç‚¹</th>
          <th>å»ºè®®åšæ³•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ä¸Šä¸‹æ–‡ä¼ é€’</td>
          <td>ä½¿ç”¨ W3C Trace Context / B3</td>
      </tr>
      <tr>
          <td>SDK æ¥å…¥</td>
          <td>ä½¿ç”¨ä¸­é—´ä»¶æˆ–æ¡†æ¶é›†æˆæ–¹å¼</td>
      </tr>
      <tr>
          <td>Trace æ•°æ®å­˜å‚¨</td>
          <td>é€‰æ‹©é«˜å¯ç”¨ã€é«˜å‹ç¼©æ¯”å­˜å‚¨æ–¹æ¡ˆ</td>
      </tr>
      <tr>
          <td>æ—¥å¿—å…³è”</td>
          <td>trace_id æ³¨å…¥æ—¥å¿—ä¸Šä¸‹æ–‡</td>
      </tr>
      <tr>
          <td>æ€§èƒ½å¼€é”€æ§åˆ¶</td>
          <td>é…ç½®é‡‡æ ·ç­–ç•¥ã€æ‰¹é‡å¯¼å‡ºæœºåˆ¶</td>
      </tr>
      <tr>
          <td>å¼‚å¸¸é“¾è·¯ç›‘æ§</td>
          <td>é‡ç‚¹æœåŠ¡é…ç½®é«˜é‡‡æ ·æˆ–å…¨é‡‡æ ·</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-java-ç¤ºä¾‹spring-boot--opentelemetry--jaeger">
  â˜• Java ç¤ºä¾‹ï¼ˆSpring Boot + OpenTelemetry + Jaegerï¼‰
  <a class="anchor" href="#-java-%e7%a4%ba%e4%be%8bspring-boot--opentelemetry--jaeger">#</a>
</h2>
<h3 id="1-maven-ä¾èµ–spring-boot-3">
  1ï¸âƒ£ Maven ä¾èµ–ï¼ˆSpring Boot 3+ï¼‰
  <a class="anchor" href="#1-maven-%e4%be%9d%e8%b5%96spring-boot-3">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>io.opentelemetry.instrumentation<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>opentelemetry-spring-boot-starter<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;version&gt;</span>1.30.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id="2-applicationyml-é…ç½®">
  2ï¸âƒ£ application.yml é…ç½®
  <a class="anchor" href="#2-applicationyml-%e9%85%8d%e7%bd%ae">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">otel</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">exporter</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">otlp</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">endpoint</span>: <span style="color:#ae81ff">http://localhost:4317</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">resource</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">attributes</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">service.name</span>: <span style="color:#ae81ff">order-service</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">tracing</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enabled</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">sampling</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">probability</span>: <span style="color:#ae81ff">1.0</span>  <span style="color:#75715e"># å¼€å‘å…¨é‡‡æ ·ï¼Œç”Ÿäº§å»ºè®®è®¾ç½®ä¸º 0.1 æˆ–é…ç½® tail-based sampling</span>
</span></span></code></pre></div><h3 id="3-æ§åˆ¶å™¨--è°ƒç”¨å¤–éƒ¨æœåŠ¡ç¤ºä¾‹">
  3ï¸âƒ£ æ§åˆ¶å™¨ + è°ƒç”¨å¤–éƒ¨æœåŠ¡ç¤ºä¾‹
  <a class="anchor" href="#3-%e6%8e%a7%e5%88%b6%e5%99%a8--%e8%b0%83%e7%94%a8%e5%a4%96%e9%83%a8%e6%9c%8d%e5%8a%a1%e7%a4%ba%e4%be%8b">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OrderController</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> RestTemplate restTemplate;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">OrderController</span>(RestTemplateBuilder builder) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">restTemplate</span> <span style="color:#f92672">=</span> builder.<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@GetMapping</span>(<span style="color:#e6db74">&#34;/order&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">createOrder</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è‡ªåŠ¨åˆ›å»º span å¹¶å…³è” traceId</span>
</span></span><span style="display:flex;"><span>        String response <span style="color:#f92672">=</span> restTemplate.<span style="color:#a6e22e">getForObject</span>(<span style="color:#e6db74">&#34;http://inventory-service/inventory&#34;</span>, String.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Order placed. Inventory Response: &#34;</span> <span style="color:#f92672">+</span> response;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="4-æ—¥å¿—æ³¨å…¥-traceid">
  4ï¸âƒ£ æ—¥å¿—æ³¨å…¥ TraceId
  <a class="anchor" href="#4-%e6%97%a5%e5%bf%97%e6%b3%a8%e5%85%a5-traceid">#</a>
</h3>
<p>ä½¿ç”¨ Logback + MDC è‡ªåŠ¨æ³¨å…¥ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - traceId=%X{trace_id} spanId=%X{span_id} %msg%n<span style="color:#f92672">&lt;/pattern&gt;</span>
</span></span></code></pre></div><hr>
<h2 id="-python-ç¤ºä¾‹fastapi--opentelemetry">
  ğŸ Python ç¤ºä¾‹ï¼ˆFastAPI + OpenTelemetryï¼‰
  <a class="anchor" href="#-python-%e7%a4%ba%e4%be%8bfastapi--opentelemetry">#</a>
</h2>
<h3 id="1-å®‰è£…ä¾èµ–">
  1ï¸âƒ£ å®‰è£…ä¾èµ–
  <a class="anchor" href="#1-%e5%ae%89%e8%a3%85%e4%be%9d%e8%b5%96">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install opentelemetry-sdk opentelemetry-instrumentation-fastapi <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>            opentelemetry-exporter-otlp opentelemetry-instrumentation-requests
</span></span></code></pre></div><h3 id="2-åˆå§‹åŒ–-otelmainpy">
  2ï¸âƒ£ åˆå§‹åŒ– OTELï¼ˆmain.pyï¼‰
  <a class="anchor" href="#2-%e5%88%9d%e5%a7%8b%e5%8c%96-otelmainpy">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> fastapi <span style="color:#f92672">import</span> FastAPI
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry <span style="color:#f92672">import</span> trace
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.instrumentation.fastapi <span style="color:#f92672">import</span> FastAPIInstrumentor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.instrumentation.requests <span style="color:#f92672">import</span> RequestsInstrumentor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.sdk.trace <span style="color:#f92672">import</span> TracerProvider
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.sdk.trace.export <span style="color:#f92672">import</span> BatchSpanProcessor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.exporter.otlp.proto.http.trace_exporter <span style="color:#f92672">import</span> OTLPSpanExporter
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.sdk.resources <span style="color:#f92672">import</span> SERVICE_NAME, Resource
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½® TracerProvider</span>
</span></span><span style="display:flex;"><span>trace<span style="color:#f92672">.</span>set_tracer_provider(
</span></span><span style="display:flex;"><span>    TracerProvider(
</span></span><span style="display:flex;"><span>        resource<span style="color:#f92672">=</span>Resource<span style="color:#f92672">.</span>create({SERVICE_NAME: <span style="color:#e6db74">&#34;inventory-service&#34;</span>})
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é…ç½®å¯¼å‡ºå™¨</span>
</span></span><span style="display:flex;"><span>trace<span style="color:#f92672">.</span>get_tracer_provider()<span style="color:#f92672">.</span>add_span_processor(
</span></span><span style="display:flex;"><span>    BatchSpanProcessor(OTLPSpanExporter(endpoint<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://localhost:4318/v1/traces&#34;</span>))
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app <span style="color:#f92672">=</span> FastAPI()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è‡ªåŠ¨æ³¨å…¥ä¸­é—´ä»¶</span>
</span></span><span style="display:flex;"><span>FastAPIInstrumentor<span style="color:#f92672">.</span>instrument_app(app)
</span></span><span style="display:flex;"><span>RequestsInstrumentor()<span style="color:#f92672">.</span>instrument()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@app.get</span>(<span style="color:#e6db74">&#34;/inventory&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_inventory</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;in-stock&#34;</span>}
</span></span></code></pre></div><h3 id="3-è°ƒç”¨é“¾ä¸Šä¸‹æ¸¸ä¼ æ’­">
  3ï¸âƒ£ è°ƒç”¨é“¾ä¸Šä¸‹æ¸¸ä¼ æ’­
  <a class="anchor" href="#3-%e8%b0%83%e7%94%a8%e9%93%be%e4%b8%8a%e4%b8%8b%e6%b8%b8%e4%bc%a0%e6%92%ad">#</a>
</h3>
<p>è°ƒç”¨ <code>inventory-service</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@app.get</span>(<span style="color:#e6db74">&#34;/order&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">place_order</span>():
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://localhost:8001/inventory&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#34;order_status&#34;</span>: <span style="color:#e6db74">&#34;created&#34;</span>, <span style="color:#e6db74">&#34;inventory&#34;</span>: r<span style="color:#f92672">.</span>json()}
</span></span></code></pre></div><p>ä¸Šä¸‹æ–‡å°†é€šè¿‡ <code>traceparent</code> header è‡ªåŠ¨ä¼ é€’ã€‚</p>
<hr>
<h2 id="-æœ€ä½³å®è·µä½“ç°">
  ğŸ¯ æœ€ä½³å®è·µä½“ç°
  <a class="anchor" href="#-%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5%e4%bd%93%e7%8e%b0">#</a>
</h2>
<table>
  <thead>
      <tr>
          <th>å®è·µç‚¹</th>
          <th>å®ç°è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>è‡ªåŠ¨ instrumentation</td>
          <td>ä½¿ç”¨äº† <code>FastAPIInstrumentor</code> / Spring Boot Starter</td>
      </tr>
      <tr>
          <td>tracecontext ä¼ é€’</td>
          <td><code>requests</code> å’Œ <code>RestTemplate</code> å‡é€šè¿‡è‡ªåŠ¨é›†æˆä¼ é€’ <code>traceparent</code></td>
      </tr>
      <tr>
          <td>trace-id æ³¨å…¥æ—¥å¿—</td>
          <td>Java é€šè¿‡ Logback çš„ <code>%X{}</code> ï¼›Python å¯ç”¨ <code>structlog</code> + è‡ªå®šä¹‰ processor</td>
      </tr>
      <tr>
          <td>æ‰¹é‡å¯¼å‡º + æ€§èƒ½ä¼˜åŒ–</td>
          <td>ä½¿ç”¨ <code>BatchSpanProcessor</code> é¿å…æ¯æ¬¡è¯·æ±‚ç«‹å³å¯¼å‡º</td>
      </tr>
      <tr>
          <td>å¯é…ç½®èµ„æºæ ‡ç­¾</td>
          <td>ä½¿ç”¨ <code>service.name</code> æ ‡è¯†æœåŠ¡åï¼Œä¾¿äºè¿½è¸ªåˆ†æ</td>
      </tr>
      <tr>
          <td>å¯¼å‡ºåˆ°é›†ä¸­å¹³å°</td>
          <td>é…ç½® OTLP å¯¼å‡ºï¼Œå¯æ¥å…¥ Jaegerã€Tempoã€Datadog ç­‰</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-æ¨èéƒ¨ç½²ç»„åˆ">
  ğŸ“¦ æ¨èéƒ¨ç½²ç»„åˆ
  <a class="anchor" href="#-%e6%8e%a8%e8%8d%90%e9%83%a8%e7%bd%b2%e7%bb%84%e5%90%88">#</a>
</h2>
<table>
  <thead>
      <tr>
          <th>ç»„ä»¶</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>OpenTelemetry Collector</td>
          <td>ç»Ÿä¸€é‡‡é›†ã€è½¬æ¢ã€è½¬å‘ trace æ•°æ®</td>
      </tr>
      <tr>
          <td>Jaeger / Grafana Tempo</td>
          <td>å¯è§†åŒ–é“¾è·¯è¿½è¸ªå›¾</td>
      </tr>
      <tr>
          <td>Prometheus + Grafana</td>
          <td>æŒ‡æ ‡è§‚æµ‹</td>
      </tr>
      <tr>
          <td>Loki / ELK</td>
          <td>æ—¥å¿—è§‚æµ‹ï¼ŒtraceId å…³è”åˆ†æ</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-ä¸€ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼ é€’">
  âœ… ä¸€ã€ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼ é€’ï¼Ÿ
  <a class="anchor" href="#-%e4%b8%80%e4%bb%80%e4%b9%88%e6%98%af%e4%b8%8a%e4%b8%8b%e6%96%87%e8%87%aa%e5%8a%a8%e4%bc%a0%e9%80%92">#</a>
</h2>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚é€šå¸¸ä¼šè·¨å¤šä¸ªæœåŠ¡ã€‚ä¾‹å¦‚ï¼š</p>
<pre tabindex="0"><code>ç”¨æˆ·è¯·æ±‚ â†’ ç½‘å…³ â†’ ç”¨æˆ·æœåŠ¡ â†’ è®¢å•æœåŠ¡ â†’ åº“å­˜æœåŠ¡
</code></pre><p>æˆ‘ä»¬å¸Œæœ›ä»ç”¨æˆ·å¼€å§‹çš„ä¸€æ¬¡è¯·æ±‚èƒ½è´¯ç©¿æ•´ä¸ªé“¾è·¯ï¼Œèƒ½åœ¨æ¯ä¸ªæœåŠ¡çœ‹åˆ°ç›¸åŒçš„ <code>trace_id</code>ï¼Œè¿™å°±éœ€è¦ï¼š</p>
<blockquote>
<p><strong>å°† trace ä¸Šä¸‹æ–‡ï¼ˆå¦‚ trace_idã€span_idï¼‰è‡ªåŠ¨ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªæœåŠ¡ï¼Œå¹¶è¢«è‡ªåŠ¨è¯†åˆ«å’Œç»§ç»­è¿½è¸ªã€‚</strong></p></blockquote>
<hr>
<h2 id="-äºŒè‡ªåŠ¨ä¸Šä¸‹æ–‡ä¼ é€’çš„æ ¸å¿ƒæœºåˆ¶">
  ğŸ”§ äºŒã€è‡ªåŠ¨ä¸Šä¸‹æ–‡ä¼ é€’çš„æ ¸å¿ƒæœºåˆ¶
  <a class="anchor" href="#-%e4%ba%8c%e8%87%aa%e5%8a%a8%e4%b8%8a%e4%b8%8b%e6%96%87%e4%bc%a0%e9%80%92%e7%9a%84%e6%a0%b8%e5%bf%83%e6%9c%ba%e5%88%b6">#</a>
</h2>
<p>OpenTelemetry ä½¿ç”¨æ ‡å‡†åè®®ï¼ˆå¦‚ 
  <a href="https://www.w3.org/TR/trace-context/">W3C Trace Context</a>ï¼‰æ¥åœ¨ä¸åŒæœåŠ¡ä¹‹é—´ä¼ é€’ traceã€‚</p>
<h3 id="-å…³é”®-header-ç¤ºä¾‹w3c-trace-context">
  ğŸ’¡ å…³é”® Header ç¤ºä¾‹ï¼ˆW3C Trace Contextï¼‰
  <a class="anchor" href="#-%e5%85%b3%e9%94%ae-header-%e7%a4%ba%e4%be%8bw3c-trace-context">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">traceparent: 00-4bf92f3577b34da6a3ce929d0e0e4736-00f067aa0ba902b7-01
</span></span></span></code></pre></div><ul>
<li><code>trace-id</code>: æ•´ä¸ªè°ƒç”¨é“¾çš„å”¯ä¸€ ID</li>
<li><code>span-id</code>: å½“å‰è°ƒç”¨çš„å”¯ä¸€ ID</li>
<li><code>trace-flags</code>: é‡‡æ ·æ ‡è®°</li>
</ul>
<hr>
<h2 id="-ä¸‰å¦‚ä½•å¯ç”¨è‡ªåŠ¨ä¼ é€’åˆ†è¯­è¨€è¯´æ˜">
  âš™ï¸ ä¸‰ã€å¦‚ä½•å¯ç”¨è‡ªåŠ¨ä¼ é€’ï¼ˆåˆ†è¯­è¨€è¯´æ˜ï¼‰
  <a class="anchor" href="#-%e4%b8%89%e5%a6%82%e4%bd%95%e5%90%af%e7%94%a8%e8%87%aa%e5%8a%a8%e4%bc%a0%e9%80%92%e5%88%86%e8%af%ad%e8%a8%80%e8%af%b4%e6%98%8e">#</a>
</h2>
<hr>
<h3 id="-javaspring-boot--opentelemetry">
  â˜• Javaï¼ˆSpring Boot / OpenTelemetryï¼‰
  <a class="anchor" href="#-javaspring-boot--opentelemetry">#</a>
</h3>
<h4 id="-ä½¿ç”¨-opentelemetry-starteræ¨è">
  âœ… ä½¿ç”¨ OpenTelemetry Starterï¼ˆæ¨èï¼‰
  <a class="anchor" href="#-%e4%bd%bf%e7%94%a8-opentelemetry-starter%e6%8e%a8%e8%8d%90">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;groupId&gt;</span>io.opentelemetry.instrumentation<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;artifactId&gt;</span>opentelemetry-spring-boot-starter<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;version&gt;</span>1.30.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>å®ƒä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹å·¥ä½œï¼š</p>
<ul>
<li>é€šè¿‡æ‹¦æˆªå™¨è‡ªåŠ¨è¯»å– <code>traceparent</code> header</li>
<li>è‡ªåŠ¨åœ¨ä½¿ç”¨ <code>RestTemplate</code>, <code>WebClient</code>, <code>gRPC</code> æ—¶æ³¨å…¥ä¸Šä¸‹æ–‡</li>
<li>è‡ªåŠ¨å…³è” <code>trace_id</code> ä¸ MDC æ—¥å¿—ä¸Šä¸‹æ–‡</li>
</ul>
<p>ğŸ“ä½ åªéœ€ç¡®ä¿è°ƒç”¨æ—¶ä½¿ç”¨æ¡†æ¶æ ‡å‡†ç»„ä»¶ï¼ˆå¦‚ <code>RestTemplate</code>, <code>WebClient</code>ï¼‰ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨é™„å¸¦ trace headerã€‚</p>
<hr>
<h3 id="-pythonfastapi--flask">
  ğŸ Pythonï¼ˆFastAPI / Flaskï¼‰
  <a class="anchor" href="#-pythonfastapi--flask">#</a>
</h3>
<h4 id="-ä½¿ç”¨è‡ªåŠ¨-instrumentation">
  âœ… ä½¿ç”¨è‡ªåŠ¨ Instrumentationï¼š
  <a class="anchor" href="#-%e4%bd%bf%e7%94%a8%e8%87%aa%e5%8a%a8-instrumentation">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install opentelemetry-instrumentation-fastapi opentelemetry-instrumentation-requests
</span></span></code></pre></div><h4 id="åˆå§‹åŒ–">
  åˆå§‹åŒ–ï¼š
  <a class="anchor" href="#%e5%88%9d%e5%a7%8b%e5%8c%96">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.instrumentation.fastapi <span style="color:#f92672">import</span> FastAPIInstrumentor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> opentelemetry.instrumentation.requests <span style="color:#f92672">import</span> RequestsInstrumentor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app <span style="color:#f92672">=</span> FastAPI()
</span></span><span style="display:flex;"><span>FastAPIInstrumentor<span style="color:#f92672">.</span>instrument_app(app)
</span></span><span style="display:flex;"><span>RequestsInstrumentor()<span style="color:#f92672">.</span>instrument()
</span></span></code></pre></div><ul>
<li>è‡ªåŠ¨ä¸º FastAPI è·¯ç”±åˆ›å»º spanï¼Œå¹¶æå– trace ä¸Šä¸‹æ–‡ï¼ˆ<code>traceparent</code>ï¼‰</li>
<li>ä½¿ç”¨ <code>requests.get()</code> æ—¶è‡ªåŠ¨æ³¨å…¥ trace header</li>
</ul>
<hr>
<h3 id="-gohttp-æˆ–-grpc">
  ğŸ¹ Goï¼ˆHTTP æˆ– gRPCï¼‰
  <a class="anchor" href="#-gohttp-%e6%88%96-grpc">#</a>
</h3>
<h4 id="-ä½¿ç”¨-otel-http-æ’ä»¶">
  âœ… ä½¿ç”¨ OTEL HTTP æ’ä»¶ï¼š
  <a class="anchor" href="#-%e4%bd%bf%e7%94%a8-otel-http-%e6%8f%92%e4%bb%b6">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">handler</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// handler è‡ªåŠ¨è·å– trace ä¸Šä¸‹æ–‡</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/my-api&#34;</span>, <span style="color:#a6e22e">otelhttp</span>.<span style="color:#a6e22e">NewHandler</span>(<span style="color:#a6e22e">handler</span>, <span style="color:#e6db74">&#34;my-api-handler&#34;</span>))
</span></span></code></pre></div><h4 id="è°ƒç”¨ä¸‹æ¸¸æœåŠ¡">
  è°ƒç”¨ä¸‹æ¸¸æœåŠ¡ï¼š
  <a class="anchor" href="#%e8%b0%83%e7%94%a8%e4%b8%8b%e6%b8%b8%e6%9c%8d%e5%8a%a1">#</a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">client</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Client</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Transport</span>: <span style="color:#a6e22e">otelhttp</span>.<span style="color:#a6e22e">NewTransport</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">DefaultTransport</span>),
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">NewRequest</span>(<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;http://other-service&#34;</span>, <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">req</span>)
</span></span></code></pre></div><p>è¿™æ ·ä¼šè‡ªåŠ¨å°† tracecontext æ’å…¥ HTTP è¯·æ±‚å¤´ã€‚</p>
<hr>
<h2 id="-å››åœ¨æ¶ˆæ¯é˜Ÿåˆ—--kafka--grpc-ä¸­ä¼ é€’ä¸Šä¸‹æ–‡">
  ğŸ“¥ å››ã€åœ¨æ¶ˆæ¯é˜Ÿåˆ— / Kafka / gRPC ä¸­ä¼ é€’ä¸Šä¸‹æ–‡
  <a class="anchor" href="#-%e5%9b%9b%e5%9c%a8%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97--kafka--grpc-%e4%b8%ad%e4%bc%a0%e9%80%92%e4%b8%8a%e4%b8%8b%e6%96%87">#</a>
</h2>
<h3 id="-kafkajava-ç¤ºä¾‹">
  ğŸ“¨ Kafkaï¼ˆJava ç¤ºä¾‹ï¼‰
  <a class="anchor" href="#-kafkajava-%e7%a4%ba%e4%be%8b">#</a>
</h3>
<ol>
<li>
<p>åœ¨ Producer ä¸­æ·»åŠ  traceparent åˆ°æ¶ˆæ¯å¤´ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ProducerRecord<span style="color:#f92672">&lt;</span>String, String<span style="color:#f92672">&gt;</span> record <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ProducerRecord<span style="color:#f92672">&lt;&gt;</span>(topic, key, value);
</span></span><span style="display:flex;"><span>GlobalOpenTelemetry.<span style="color:#a6e22e">getPropagators</span>().<span style="color:#a6e22e">getTextMapPropagator</span>().<span style="color:#a6e22e">inject</span>(
</span></span><span style="display:flex;"><span>    Context.<span style="color:#a6e22e">current</span>(), record.<span style="color:#a6e22e">headers</span>(), setter);
</span></span></code></pre></div></li>
<li>
<p>åœ¨ Consumer ä¸­æå–å¹¶ç»§ç»­è¿½è¸ªï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Context extractedContext <span style="color:#f92672">=</span> propagators.<span style="color:#a6e22e">extract</span>(Context.<span style="color:#a6e22e">current</span>(), record.<span style="color:#a6e22e">headers</span>(), getter);
</span></span><span style="display:flex;"><span>Span span <span style="color:#f92672">=</span> tracer.<span style="color:#a6e22e">spanBuilder</span>(<span style="color:#e6db74">&#34;kafka-consume&#34;</span>).<span style="color:#a6e22e">setParent</span>(extractedContext).<span style="color:#a6e22e">startSpan</span>();
</span></span></code></pre></div></li>
</ol>
<hr>
<h2 id="-äº”éƒ¨ç½²ç¯å¢ƒè¦æ±‚">
  âœ… äº”ã€éƒ¨ç½²ç¯å¢ƒè¦æ±‚
  <a class="anchor" href="#-%e4%ba%94%e9%83%a8%e7%bd%b2%e7%8e%af%e5%a2%83%e8%a6%81%e6%b1%82">#</a>
</h2>
<ul>
<li>æ‰€æœ‰æœåŠ¡éƒ½è¦ç»Ÿä¸€ä½¿ç”¨æ”¯æŒ OpenTelemetry çš„ SDK å’Œä¼ æ’­æœºåˆ¶</li>
<li>å»ºè®®é€šè¿‡ <strong>OpenTelemetry Collector</strong> ä¸­è½¬ trace æ•°æ®ï¼Œç®€åŒ–é…ç½®</li>
<li>åœ¨ Istio / Linkerd ç­‰æœåŠ¡ç½‘æ ¼ä¸­ä½¿ç”¨æ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ mesh è‡ªåŠ¨å¤„ç† trace header</li>
</ul>
<hr>
<h2 id="-å…­éªŒè¯è‡ªåŠ¨ä¸Šä¸‹æ–‡æ˜¯å¦ä¼ é€’æˆåŠŸ">
  ğŸ§ª å…­ã€éªŒè¯è‡ªåŠ¨ä¸Šä¸‹æ–‡æ˜¯å¦ä¼ é€’æˆåŠŸ
  <a class="anchor" href="#-%e5%85%ad%e9%aa%8c%e8%af%81%e8%87%aa%e5%8a%a8%e4%b8%8a%e4%b8%8b%e6%96%87%e6%98%af%e5%90%a6%e4%bc%a0%e9%80%92%e6%88%90%e5%8a%9f">#</a>
</h2>
<p>ä½ å¯ä»¥åœ¨æ¯ä¸ªæœåŠ¡æ‰“å°å½“å‰ trace_id æˆ–åœ¨æ—¥å¿—ä¸­è§‚å¯Ÿ trace_id æ˜¯å¦ä¸€è‡´ï¼š</p>
<p>Java ç¤ºä¾‹ï¼ˆLogbackï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>%X{trace_id} %X{span_id} %msg%n
</span></span></code></pre></div><p>Python ç¤ºä¾‹ï¼ˆstructlogï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>log <span style="color:#f92672">=</span> structlog<span style="color:#f92672">.</span>get_logger()<span style="color:#f92672">.</span>bind(trace_id<span style="color:#f92672">=</span>trace<span style="color:#f92672">.</span>get_current_span()<span style="color:#f92672">.</span>get_span_context()<span style="color:#f92672">.</span>trace_id)
</span></span></code></pre></div><hr>
<h2 id="-ä¸ƒå°ç»“">
  ğŸ§  ä¸ƒã€å°ç»“
  <a class="anchor" href="#-%e4%b8%83%e5%b0%8f%e7%bb%93">#</a>
</h2>
<table>
  <thead>
      <tr>
          <th>é¡¹ç›®</th>
          <th>æœ€ä½³å®è·µ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ä½¿ç”¨æ ‡å‡† Header</td>
          <td>å»ºè®®ä½¿ç”¨ <code>W3C Trace Context</code>ï¼ˆé»˜è®¤ï¼‰</td>
      </tr>
      <tr>
          <td>HTTP è°ƒç”¨</td>
          <td>ä½¿ç”¨æ¡†æ¶é›†æˆç»„ä»¶ï¼ˆå¦‚ RestTemplateã€requestsï¼‰</td>
      </tr>
      <tr>
          <td>æ¶ˆæ¯é˜Ÿåˆ— / å¼‚æ­¥</td>
          <td>é€šè¿‡ headers æ‰‹åŠ¨ä¼ é€’ä¸Šä¸‹æ–‡</td>
      </tr>
      <tr>
          <td>æœåŠ¡ç»Ÿä¸€ SDK é…ç½®</td>
          <td>ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ OTEL SDK å’Œ propagator</td>
      </tr>
      <tr>
          <td>æ—¥å¿—ä¸è¿½è¸ªå…³è”</td>
          <td>å°† trace_id æ³¨å…¥æ—¥å¿—ä¸Šä¸‹æ–‡</td>
      </tr>
  </tbody>
</table>
</div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">



</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>



<div class="busuanzi-footer">
  <p>Â© 2025 Powered By <a href="https://themes.gohugo.io/">Hugo</a> & 
    <a href="https://github.com/alex-shpak/hugo-book">Hugo-book</a> Contact: <a href="mailto:j.duan@foxmail.com">j.duan@foxmail.com</a></p> 
  <span id="busuanzi_container_site_pv">
    æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
  </span>
  <span id="busuanzi_container_site_uv">
    æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡
  </span>
</div>
 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<style>
    .no-marker::marker {
        content: none;
    }
</style>
<li class="no-marker"><a href="#OpenTelemetry%20%e5%85%a8%e9%93%be%e8%b7%af%e8%bf%bd%e8%b8%aa">OpenTelemetry å…¨é“¾è·¯è¿½è¸ª</a></li>
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#-ä¸€opentelemetry-ç®€ä»‹">ğŸŒ ä¸€ã€OpenTelemetry ç®€ä»‹</a></li>
        <li><a href="#-äºŒå…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ">ğŸ“¦ äºŒã€å…¨é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ</a></li>
        <li><a href="#-ä¸‰åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨-opentelemetry-çš„æœ€ä½³å®è·µ">ğŸ”§ ä¸‰ã€åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ OpenTelemetry çš„æœ€ä½³å®è·µ</a>
          <ul>
            <li><a href="#-1-ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥">âœ… 1. <strong>ç»Ÿä¸€è§„èŒƒå’Œè‡ªåŠ¨åŒ–æ¥å…¥</strong></a></li>
            <li><a href="#-2-ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’context-propagation">ğŸ”— 2. <strong>ç»Ÿä¸€ä¸Šä¸‹æ–‡ä¼ é€’ï¼ˆContext Propagationï¼‰</strong></a></li>
            <li><a href="#-3-é€‰æ‹©åˆé€‚çš„åç«¯exporter">ğŸ“¤ 3. <strong>é€‰æ‹©åˆé€‚çš„åç«¯ï¼ˆExporterï¼‰</strong></a></li>
            <li><a href="#-4-æ•´åˆæ—¥å¿—ä¸æŒ‡æ ‡logs--metrics">ğŸ§© 4. <strong>æ•´åˆæ—¥å¿—ä¸æŒ‡æ ‡ï¼ˆLogs &amp; Metricsï¼‰</strong></a></li>
            <li><a href="#-5-é‡‡æ ·ç­–ç•¥samplingè®¾è®¡">ğŸ“Š 5. <strong>é‡‡æ ·ç­–ç•¥ï¼ˆSamplingï¼‰è®¾è®¡</strong></a></li>
            <li><a href="#-6-å¼‚æ­¥è°ƒç”¨ä¸æ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ">ğŸ§ª 6. <strong>å¼‚æ­¥è°ƒç”¨ä¸æ¶ˆæ¯é˜Ÿåˆ—æ”¯æŒ</strong></a></li>
            <li><a href="#-7-éƒ¨ç½²ä¸ç›‘æ§å»ºè®®">ğŸš€ 7. <strong>éƒ¨ç½²ä¸ç›‘æ§å»ºè®®</strong></a></li>
          </ul>
        </li>
        <li><a href="#-å››å·¥å…·é“¾æ¨è">ğŸ§° å››ã€å·¥å…·é“¾æ¨è</a></li>
        <li><a href="#-äº”æ€»ç»“">ğŸ§  äº”ã€æ€»ç»“</a></li>
        <li><a href="#-java-ç¤ºä¾‹spring-boot--opentelemetry--jaeger">â˜• Java ç¤ºä¾‹ï¼ˆSpring Boot + OpenTelemetry + Jaegerï¼‰</a>
          <ul>
            <li><a href="#1-maven-ä¾èµ–spring-boot-3">1ï¸âƒ£ Maven ä¾èµ–ï¼ˆSpring Boot 3+ï¼‰</a></li>
            <li><a href="#2-applicationyml-é…ç½®">2ï¸âƒ£ application.yml é…ç½®</a></li>
            <li><a href="#3-æ§åˆ¶å™¨--è°ƒç”¨å¤–éƒ¨æœåŠ¡ç¤ºä¾‹">3ï¸âƒ£ æ§åˆ¶å™¨ + è°ƒç”¨å¤–éƒ¨æœåŠ¡ç¤ºä¾‹</a></li>
            <li><a href="#4-æ—¥å¿—æ³¨å…¥-traceid">4ï¸âƒ£ æ—¥å¿—æ³¨å…¥ TraceId</a></li>
          </ul>
        </li>
        <li><a href="#-python-ç¤ºä¾‹fastapi--opentelemetry">ğŸ Python ç¤ºä¾‹ï¼ˆFastAPI + OpenTelemetryï¼‰</a>
          <ul>
            <li><a href="#1-å®‰è£…ä¾èµ–">1ï¸âƒ£ å®‰è£…ä¾èµ–</a></li>
            <li><a href="#2-åˆå§‹åŒ–-otelmainpy">2ï¸âƒ£ åˆå§‹åŒ– OTELï¼ˆmain.pyï¼‰</a></li>
            <li><a href="#3-è°ƒç”¨é“¾ä¸Šä¸‹æ¸¸ä¼ æ’­">3ï¸âƒ£ è°ƒç”¨é“¾ä¸Šä¸‹æ¸¸ä¼ æ’­</a></li>
          </ul>
        </li>
        <li><a href="#-æœ€ä½³å®è·µä½“ç°">ğŸ¯ æœ€ä½³å®è·µä½“ç°</a></li>
        <li><a href="#-æ¨èéƒ¨ç½²ç»„åˆ">ğŸ“¦ æ¨èéƒ¨ç½²ç»„åˆ</a></li>
        <li><a href="#-ä¸€ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼ é€’">âœ… ä¸€ã€ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡è‡ªåŠ¨ä¼ é€’ï¼Ÿ</a></li>
        <li><a href="#-äºŒè‡ªåŠ¨ä¸Šä¸‹æ–‡ä¼ é€’çš„æ ¸å¿ƒæœºåˆ¶">ğŸ”§ äºŒã€è‡ªåŠ¨ä¸Šä¸‹æ–‡ä¼ é€’çš„æ ¸å¿ƒæœºåˆ¶</a>
          <ul>
            <li><a href="#-å…³é”®-header-ç¤ºä¾‹w3c-trace-context">ğŸ’¡ å…³é”® Header ç¤ºä¾‹ï¼ˆW3C Trace Contextï¼‰</a></li>
          </ul>
        </li>
        <li><a href="#-ä¸‰å¦‚ä½•å¯ç”¨è‡ªåŠ¨ä¼ é€’åˆ†è¯­è¨€è¯´æ˜">âš™ï¸ ä¸‰ã€å¦‚ä½•å¯ç”¨è‡ªåŠ¨ä¼ é€’ï¼ˆåˆ†è¯­è¨€è¯´æ˜ï¼‰</a>
          <ul>
            <li><a href="#-javaspring-boot--opentelemetry">â˜• Javaï¼ˆSpring Boot / OpenTelemetryï¼‰</a></li>
            <li><a href="#-pythonfastapi--flask">ğŸ Pythonï¼ˆFastAPI / Flaskï¼‰</a></li>
            <li><a href="#-gohttp-æˆ–-grpc">ğŸ¹ Goï¼ˆHTTP æˆ– gRPCï¼‰</a></li>
          </ul>
        </li>
        <li><a href="#-å››åœ¨æ¶ˆæ¯é˜Ÿåˆ—--kafka--grpc-ä¸­ä¼ é€’ä¸Šä¸‹æ–‡">ğŸ“¥ å››ã€åœ¨æ¶ˆæ¯é˜Ÿåˆ— / Kafka / gRPC ä¸­ä¼ é€’ä¸Šä¸‹æ–‡</a>
          <ul>
            <li><a href="#-kafkajava-ç¤ºä¾‹">ğŸ“¨ Kafkaï¼ˆJava ç¤ºä¾‹ï¼‰</a></li>
          </ul>
        </li>
        <li><a href="#-äº”éƒ¨ç½²ç¯å¢ƒè¦æ±‚">âœ… äº”ã€éƒ¨ç½²ç¯å¢ƒè¦æ±‚</a></li>
        <li><a href="#-å…­éªŒè¯è‡ªåŠ¨ä¸Šä¸‹æ–‡æ˜¯å¦ä¼ é€’æˆåŠŸ">ğŸ§ª å…­ã€éªŒè¯è‡ªåŠ¨ä¸Šä¸‹æ–‡æ˜¯å¦ä¼ é€’æˆåŠŸ</a></li>
        <li><a href="#-ä¸ƒå°ç»“">ğŸ§  ä¸ƒã€å°ç»“</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












