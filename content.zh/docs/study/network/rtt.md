---
title: 往返时间（Round Trip Time）
---

# 🔁 什么是 RTT？

* **RTT（Round Trip Time）**：一个完整的“请求-响应”往返时间。
* 当我们说 **2-RTT**，意思是连接建立需要 2 次完整的往返消息交互。

---

# ✅ 一、2-RTT 连接建立流程（TCP + TLS 1.2）

这是传统 HTTPS 的流程：TCP + TLS 1.2。

### ⏱️ 所需 RTT：**2 次**

### 🔄 过程：

#### 🧩 第 1 RTT：TCP 三次握手（连接层）

1. 客户端发送 `SYN` → 请求建立连接
2. 服务端回复 `SYN + ACK`
3. 客户端回复 `ACK` → **TCP 连接建立**

---

#### 🧩 第 2 RTT：TLS 1.2 握手（安全层）

1. 客户端发送 `ClientHello`（包含加密参数）
2. 服务端返回 `ServerHello` + 证书 + 公钥
3. 客户端验证证书、协商密钥，发送加密的 `PreMasterSecret`
4. 服务端确认密钥后双方可开始加密通信

👉 **总共两次 RTT 才能开始传输应用层数据（如 HTTP 请求）**

---

#### 📉 缺点：

* 首次访问慢（两次往返后才开始业务请求）
* 移动网络等高延迟环境体验差

---

# ✅ 二、1-RTT 连接建立流程（TCP + TLS 1.3）

TLS 1.3 简化了握手过程，将关键加密参数协商合并。

### ⏱️ 所需 RTT：**1 次**

### 🔄 过程：

#### 🧩 第 1 RTT：TCP 三次握手 + TLS 合并

1. 客户端发送 TCP `SYN`
2. 服务端回复 `SYN+ACK`
3. 客户端发送 `ACK`
   ↳ 同时发送 `ClientHello`（TLS 1.3 中可带早期加密参数）

---

#### ✅ 服务端收到后，直接返回 `ServerHello + Finished`

* 双方直接进入加密阶段，客户端可以立即发起请求（如 HTTP）

👉 整个过程只需要 **1 个 RTT 就能开始传输业务数据**

---

#### 📈 优点：

* 更快连接建立
* 更强加密机制（剔除 RSA、非对称证书漏洞）

---

# ✅ 三、0-RTT 连接建立流程（QUIC + TLS 1.3）

0-RTT 是在复用历史连接的基础上实现的，是 TLS 1.3 + 会话恢复的一种加速手段。

### ⏱️ 所需 RTT：**0 次**（针对“已连接过”的服务器）

### 🔄 过程：

#### 🧩 第一次连接（还是需要 1-RTT）

* 正常建立连接（如 TLS 1.3）
* 客户端保存“会话票据”（session ticket）或 0-RTT 密钥

---

#### 🧩 第二次连接（0-RTT）

1. 客户端直接发送加密数据 + `ClientHello` + 0-RTT 密钥（无需等待回应）
2. 服务端验证密钥，若通过 → 接受请求
   否则 → 拒绝 0-RTT 数据，要求重新握手

---

#### 📉 缺点：

* ⚠️ **有重放攻击风险**

  * 同一个 0-RTT 数据包可能被攻击者重放多次
* 因此 **只适合幂等请求（如 GET），不能用于登录/支付类 POST**

---

#### ✅ 优点：

* 极致速度（CDN、移动端常见）
* HTTP/3（基于 QUIC）原生支持 0-RTT

---

# 🧠 总结对比表：

| 类型    | 往返次数 | 协议示例                    | 是否支持早期数据 | 优点              | 缺点             |
| ----- | ---- | ----------------------- | -------- | --------------- | -------------- |
| 2-RTT | 2 次  | TCP + TLS 1.2           | ❌        | 传统 HTTPS，兼容广    | 慢、连接建立耗时       |
| 1-RTT | 1 次  | TCP + TLS 1.3           | ✅        | 安全+快，广泛支持       | 首次连接仍需 1 次往返   |
| 0-RTT | 0 次  | QUIC + TLS 1.3 (HTTP/3) | ✅        | 极速连接，移动端/缓存场景优秀 | 有重放风险，非幂等接口不安全 |

---

# 🎯 实际使用建议：

| 场景              | 推荐类型            | 原因            |
| --------------- | --------------- | ------------- |
| 首次访问 Web 站点     | 1-RTT (TLS 1.3) | 安全、快速、浏览器兼容性好 |
| CDN 静态资源/高频请求   | 0-RTT (QUIC)    | 快速建立连接，减少延迟   |
| 微服务内部调用（HTTP/2） | 1-RTT           | 性能平衡，避免重放攻击   |
| 安全性要求高的服务       | 禁用 0-RTT        | 防止敏感接口遭重放攻击   |